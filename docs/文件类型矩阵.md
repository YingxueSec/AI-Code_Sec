# 📊 文件类型分析矩阵

## 🎯 文件类型 vs 分析策略对照表

### 📋 完整文件类型支持矩阵

| 文件类型 | 扩展名 | 默认分析 | 安全重点 | 检测能力 | 推荐场景 |
|----------|--------|----------|----------|----------|----------|
| **Java** | `.java` | ✅ | SQL注入、反序列化、权限 | ⭐⭐⭐⭐⭐ | 企业应用 |
| **Python** | `.py` | ✅ | 命令注入、反序列化、路径遍历 | ⭐⭐⭐⭐⭐ | Web应用、脚本 |
| **JavaScript** | `.js` | ✅ | XSS、CSRF、DOM安全 | ⭐⭐⭐⭐⭐ | 前端、Node.js |
| **HTML** | `.html`, `.htm` | ✅ | XSS、点击劫持、信息泄露 | ⭐⭐⭐⭐ | Web前端 |
| **CSS** | `.css` | ✅ | CSS注入、信息泄露 | ⭐⭐⭐ | 样式安全 |
| **PHP** | `.php` | ✅ | 文件包含、代码执行、SQL注入 | ⭐⭐⭐⭐⭐ | Web应用 |
| **TypeScript** | `.ts`, `.tsx` | ✅ | 类型安全、XSS | ⭐⭐⭐⭐ | 现代前端 |
| **React** | `.jsx`, `.tsx` | ✅ | 组件安全、状态管理 | ⭐⭐⭐⭐ | React应用 |
| **Vue** | `.vue` | ✅ | 模板注入、XSS | ⭐⭐⭐⭐ | Vue应用 |
| **Go** | `.go` | ✅ | 并发安全、输入验证 | ⭐⭐⭐⭐ | 微服务 |
| **C#** | `.cs` | ✅ | 反序列化、SQL注入 | ⭐⭐⭐⭐ | .NET应用 |
| **Ruby** | `.rb` | ✅ | 代码执行、SQL注入 | ⭐⭐⭐⭐ | Rails应用 |
| **XML** | `.xml` | ✅ | XXE、配置泄露 | ⭐⭐⭐⭐ | 配置文件 |
| **JSON** | `.json` | ✅ | 敏感信息泄露 | ⭐⭐⭐ | 配置文件 |
| **SQL** | `.sql` | ✅ | SQL注入、权限配置 | ⭐⭐⭐⭐ | 数据库脚本 |
| **Shell** | `.sh`, `.bat` | ✅ | 命令注入、权限提升 | ⭐⭐⭐⭐ | 部署脚本 |

## 🎛️ 命令策略对照表

### 🔧 基础命令策略

| 命令 | 文件范围 | 分析重点 | 性能 | 适用场景 |
|------|----------|----------|------|----------|
| `python main.py project` | 全栈代码 (67%) | 全面安全 | 标准 | 首次全面审计 |
| `python main.py project --quick` | 核心文件 (12%) | 高风险问题 | 快速 | 日常检查 |
| `python main.py project --all` | 所有文件 (100%) | 深度分析 | 慢 | 深度审计 |
| `python main.py project --no-filter` | 所有代码 (100%) | 无遗漏 | 慢 | 怀疑有隐藏问题 |

### 🎯 扩展名过滤策略

#### **包含特定文件类型**
| 命令 | 分析文件 | 检测重点 | 用时 | 场景 |
|------|----------|----------|------|------|
| `--include-extensions .html` | 39个HTML | XSS、点击劫持 | 4秒 | 前端XSS专项 |
| `--include-extensions .java` | 235个Java | SQL注入、权限 | 100秒 | Java代码审计 |
| `--include-extensions .js .jsx .tsx` | 45个JS文件 | XSS、CSRF | 20秒 | JavaScript安全 |
| `--include-extensions .xml .json` | 43个配置 | 配置安全 | 15秒 | 配置文件审计 |
| `--include-extensions .py` | Python文件 | 命令注入、路径遍历 | 变化 | Python专项 |

#### **排除特定文件类型**
| 命令 | 排除文件 | 分析内容 | 效果 | 场景 |
|------|----------|----------|------|------|
| `--exclude-extensions .html .css .js` | 112个前端 | 245个后端 | 后端专项 | 后端安全审计 |
| `--exclude-extensions .xml .json` | 43个配置 | 241个代码 | 代码专项 | 纯代码审计 |
| `--exclude-extensions .md .txt` | 文档文件 | 所有代码 | 去除文档 | 代码安全专项 |

### 🗂️ 路径过滤策略

#### **包含特定路径**
| 命令 | 分析路径 | 文件数 | 检测重点 | 场景 |
|------|----------|--------|----------|------|
| `--include-paths src/main/java` | Java源码目录 | 235个 | Java业务逻辑 | Java专项审计 |
| `--include-paths src/ lib/` | 源码和库 | 变化 | 核心代码 | 核心代码审计 |
| `--include-paths api/ controllers/` | API层 | 变化 | API安全 | API安全专项 |
| `--include-paths frontend/ static/` | 前端目录 | 变化 | 前端安全 | 前端专项审计 |

#### **排除特定路径**
| 命令 | 排除路径 | 效果 | 性能提升 | 场景 |
|------|----------|------|----------|------|
| `--exclude-paths test/ tests/` | 测试代码 | 专注业务代码 | 20-30% | 生产代码审计 |
| `--exclude-paths node_modules/ vendor/` | 依赖库 | 避免第三方误报 | 50%+ | 自有代码审计 |
| `--exclude-paths build/ dist/ target/` | 编译产物 | 只审计源码 | 30-40% | 源码安全审计 |
| `--exclude-paths docs/ examples/` | 文档示例 | 专注核心功能 | 10-20% | 核心功能审计 |

## 🎨 技术栈专用命令

### ☕ **Java技术栈**
```bash
# Spring Boot项目
python main.py project \
  --include-extensions .java .jsp .xml .properties \
  --exclude-paths test/ target/ \
  --template owasp_top_10_2021

# MyBatis项目  
python main.py project \
  --include-extensions .java .xml .sql \
  --include-paths src/main/ \
  --template security_audit_chinese
```

### 🐍 **Python技术栈**
```bash
# Django项目
python main.py project \
  --include-extensions .py .html .css .js \
  --exclude-paths venv/ __pycache__/ migrations/ \
  --template security_audit_chinese

# Flask API项目
python main.py project \
  --include-extensions .py .json \
  --exclude-paths venv/ test/ \
  --template security_audit_chinese
```

### 🌐 **前端技术栈**
```bash
# React项目
python main.py project \
  --include-extensions .jsx .tsx .js .ts .html .css \
  --exclude-paths node_modules/ build/ \
  --template security_audit_chinese

# Vue项目
python main.py project \
  --include-extensions .vue .js .ts .html .css \
  --exclude-paths node_modules/ dist/ \
  --template security_audit_chinese

# 纯HTML/JS项目
python main.py project \
  --include-extensions .html .css .js \
  --exclude-paths libs/ vendor/ \
  --template security_audit_chinese
```

### 🚀 **Node.js技术栈**
```bash
# Express API项目
python main.py project \
  --include-extensions .js .ts .json \
  --include-paths src/ routes/ controllers/ \
  --exclude-paths node_modules/ test/ \
  --template security_audit_chinese

# 全栈Node.js项目
python main.py project \
  --include-extensions .js .ts .jsx .tsx .html .css \
  --exclude-paths node_modules/ build/ test/ \
  --template security_audit_chinese
```

## 📊 实际项目分析数据

### 🏢 **企业项目案例分析**

#### **案例1: 大型Java Web项目**
```
项目规模: 1200个文件
默认分析: 800个文件 (67%)
分析时间: 15分钟 (首次) / 2秒 (重复)

文件分布:
- Java源码: 450个 (业务逻辑)
- JSP页面: 80个 (页面模板)  
- XML配置: 120个 (Spring、MyBatis)
- JavaScript: 100个 (前端交互)
- HTML静态: 50个 (静态页面)

发现问题: 45个安全问题
- SQL注入: 15个
- XSS漏洞: 12个  
- 权限绕过: 8个
- 配置安全: 6个
- 其他: 4个
```

#### **案例2: React前端项目**
```
项目规模: 800个文件
前端专项: 320个文件 (40%)
分析时间: 8分钟 (首次) / 1秒 (重复)

文件分布:
- JSX组件: 180个 (React组件)
- TypeScript: 80个 (业务逻辑)
- CSS模块: 40个 (组件样式)
- HTML模板: 20个 (页面模板)

发现问题: 18个安全问题
- XSS漏洞: 8个
- CSRF风险: 4个
- DOM安全: 3个
- 敏感信息: 2个
- 其他: 1个
```

#### **案例3: 微服务API项目**
```
项目规模: 400个文件
API专项: 150个文件 (38%)
分析时间: 5分钟 (首次) / 1秒 (重复)

文件分布:
- Controller: 60个 (API接口)
- Service: 50个 (业务逻辑)
- Repository: 25个 (数据访问)
- 配置文件: 15个 (应用配置)

发现问题: 22个安全问题
- 权限绕过: 8个
- 输入验证: 6个
- SQL注入: 4个
- API安全: 3个
- 其他: 1个
```

## 🎉 总结

### ✅ **v2.4.0 文件分析能力**

1. **✅ 全面支持**: 15种编程语言，4大文件类别
2. **✅ 精确控制**: 扩展名和路径过滤完全正常
3. **✅ 智能优化**: 自动过滤无关文件，提升效率
4. **✅ 性能卓越**: 缓存机制提供4725倍提升
5. **✅ 灵活配置**: 支持各种项目类型和审计需求

### 🎯 **选择建议**

- **首次审计**: 使用默认分析，获得全面覆盖
- **专项审计**: 使用扩展名过滤，专注特定技术栈
- **快速检查**: 使用`--quick`和`--max-files`
- **深度分析**: 使用`--no-filter`和`--all`
- **CI/CD集成**: 使用路径过滤排除测试代码

**💡 记住**: 合适的分析策略 = 更高的效率 + 更准确的结果！
