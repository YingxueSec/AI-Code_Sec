graph TB
    subgraph "ç”¨æˆ·å±‚"
        U1["ğŸ‘¤ ç”¨æˆ·A"]
        U2["ğŸ‘¤ ç”¨æˆ·B"] 
        U3["ğŸ‘¤ ç”¨æˆ·C"]
    end
    
    subgraph "å®¡è®¡å¼•æ“"
        AE["ğŸš€ AuditEngine<br/>ä¸»å¼•æ“"]
        SM["ğŸ“‹ SessionManager<br/>ä¼šè¯ç®¡ç†å™¨"]
        SI["ğŸ”’ SessionIsolationManager<br/>ä¼šè¯éš”ç¦»ç®¡ç†å™¨"]
    end
    
    subgraph "ä¼šè¯å±‚"
        S1["ğŸ”„ Session-1<br/>é¡¹ç›®Aå®¡è®¡<br/>ç”¨æˆ·Aå‘èµ·"]
        S2["ğŸ”„ Session-2<br/>é¡¹ç›®Bå®¡è®¡<br/>ç”¨æˆ·Bå‘èµ·"]
        S3["ğŸ”„ Session-3<br/>é¡¹ç›®Aå®¡è®¡<br/>ç”¨æˆ·Cå‘èµ·"]
        S4["ğŸ”„ Session-4<br/>é¡¹ç›®Cå®¡è®¡<br/>ç”¨æˆ·Aå‘èµ·"]
    end
    
    subgraph "éš”ç¦»ä¸Šä¸‹æ–‡"
        subgraph "Session-1ç¯å¢ƒ"
            SC1["ğŸ“¦ SessionContext-1"]
            MN1["ğŸ§  å†…å­˜å‘½åç©ºé—´<br/>session_1_memory"]
            CN1["ğŸ’¾ ç¼“å­˜å‘½åç©ºé—´<br/>session_1_cache"]
            TD1["ğŸ“ ä¸´æ—¶ç›®å½•<br/>/tmp/session_1/"]
        end
        
        subgraph "Session-2ç¯å¢ƒ"
            SC2["ğŸ“¦ SessionContext-2"]
            MN2["ğŸ§  å†…å­˜å‘½åç©ºé—´<br/>session_2_memory"]
            CN2["ğŸ’¾ ç¼“å­˜å‘½åç©ºé—´<br/>session_2_cache"]
            TD2["ğŸ“ ä¸´æ—¶ç›®å½•<br/>/tmp/session_2/"]
        end
        
        subgraph "Session-3ç¯å¢ƒ"
            SC3["ğŸ“¦ SessionContext-3"]
            MN3["ğŸ§  å†…å­˜å‘½åç©ºé—´<br/>session_3_memory"]
            CN3["ğŸ’¾ ç¼“å­˜å‘½åç©ºé—´<br/>session_3_cache"]
            TD3["ğŸ“ ä¸´æ—¶ç›®å½•<br/>/tmp/session_3/"]
        end
    end
    
    subgraph "å…±äº«èµ„æºå±‚"
        SR1["ğŸ—‚ï¸ é¡¹ç›®å…ƒæ•°æ®ç¼“å­˜<br/>åªè¯»å…±äº«"]
        SR2["ğŸ¤– LLMæ¨¡å‹ç¼“å­˜<br/>åªè¯»å…±äº«"]
        SR3["ğŸ›¡ï¸ å®‰å…¨è§„åˆ™åº“<br/>åªè¯»å…±äº«"]
        SR4["ğŸ—„ï¸ åˆ†æç»“æœæ•°æ®åº“<br/>è¯»å†™æ§åˆ¶"]
    end
    
    subgraph "é¡¹ç›®å±‚"
        P1["ğŸ“‚ é¡¹ç›®A<br/>ä»£ç ä»“åº“"]
        P2["ğŸ“‚ é¡¹ç›®B<br/>ä»£ç ä»“åº“"]
        P3["ğŸ“‚ é¡¹ç›®C<br/>ä»£ç ä»“åº“"]
    end
    
    %% ç”¨æˆ·åˆ°ä¼šè¯çš„å…³ç³»
    U1 --> S1
    U1 --> S4
    U2 --> S2
    U3 --> S3
    
    %% å¼•æ“ç®¡ç†å…³ç³»
    AE --> SM
    AE --> SI
    SM --> S1
    SM --> S2
    SM --> S3
    SM --> S4
    
    %% ä¼šè¯éš”ç¦»å…³ç³»
    SI --> SC1
    SI --> SC2
    SI --> SC3
    S1 --> SC1
    S2 --> SC2
    S3 --> SC3
    
    %% éš”ç¦»ä¸Šä¸‹æ–‡å†…éƒ¨å…³ç³»
    SC1 --> MN1
    SC1 --> CN1
    SC1 --> TD1
    SC2 --> MN2
    SC2 --> CN2
    SC2 --> TD2
    SC3 --> MN3
    SC3 --> CN3
    SC3 --> TD3
    
    %% ä¼šè¯åˆ°é¡¹ç›®çš„å…³ç³»
    S1 --> P1
    S2 --> P2
    S3 --> P1
    S4 --> P3
    
    %% å…±äº«èµ„æºè®¿é—®
    S1 -.->|å—æ§è®¿é—®| SR1
    S1 -.->|å—æ§è®¿é—®| SR2
    S1 -.->|å—æ§è®¿é—®| SR3
    S1 -.->|å—æ§è®¿é—®| SR4
    S2 -.->|å—æ§è®¿é—®| SR1
    S2 -.->|å—æ§è®¿é—®| SR2
    S2 -.->|å—æ§è®¿é—®| SR3
    S2 -.->|å—æ§è®¿é—®| SR4
    S3 -.->|å—æ§è®¿é—®| SR1
    S3 -.->|å—æ§è®¿é—®| SR2
    S3 -.->|å—æ§è®¿é—®| SR3
    S3 -.->|å—æ§è®¿é—®| SR4
