stateDiagram-v2
    [*] --> 创建中: 用户发起审计请求
    创建中 --> 运行中: 隔离环境准备完成
    运行中 --> 暂停中: 用户暂停请求
    暂停中 --> 运行中: 用户恢复请求
    运行中 --> 完成: 审计任务完成
    运行中 --> 失败: 审计过程出错
    暂停中 --> 超时清理: 长时间未恢复
    完成 --> 清理中: 开始资源清理
    失败 --> 清理中: 开始资源清理
    超时清理 --> 清理中: 开始资源清理
    清理中 --> [*]: 资源清理完成
    
    note right of 创建中
        - 分配会话ID
        - 创建隔离环境
        - 初始化资源
    end note
    
    note right of 运行中
        - 执行代码分析
        - 更新进度状态
        - 生成分析结果
    end note
    
    note right of 清理中
        - 清理临时文件
        - 释放内存缓存
        - 保存最终结果
    end note
