[
  {
    "file": "test_complete_report.py",
    "language": "python",
    "analysis": "# ğŸš¨ æ¼æ´åˆ†ææŠ¥å‘Šï¼štest_complete_report.py\n\n---\n\n## ğŸš¨ æ¼æ´ #1ï¼šSQLæ³¨å…¥æ¼æ´ï¼ˆSQL Injectionï¼‰\n- **OWASPåˆ†ç±»**ï¼šA03:2021 - æ•°æ®æ³„éœ²\n- **CWEç¼–å·**ï¼šCWE-89\n- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸¥é‡\n- **ä½ç½®**ï¼šç¬¬6-7è¡Œï¼Œæ–‡ä»¶ test_complete_report.py\n- **ä»£ç ç‰‡æ®µ**ï¼š\n```python\ndef sql_injection_vuln(user_id):\n    # SQLæ³¨å…¥æ¼æ´ç¤ºä¾‹\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    return query\n```\n- **æ”»å‡»åœºæ™¯**ï¼š\n  1. æ”»å‡»è€…æ„é€ æ¶æ„è¾“å…¥å¦‚ `' OR 1=1 --` ä½œä¸º `user_id`ã€‚\n  2. æœ€ç»ˆSQLè¯­å¥å˜ä¸ºï¼š\n     ```sql\n     SELECT * FROM users WHERE id = '' OR 1=1 --'\n     ```\n  3. è¿™å°†å¯¼è‡´æŸ¥è¯¢è¿”å›æ‰€æœ‰ç”¨æˆ·æ•°æ®ï¼Œç»•è¿‡èº«ä»½éªŒè¯æˆ–è·å–æ•æ„Ÿä¿¡æ¯ã€‚\n- **ä¸šåŠ¡å½±å“**ï¼š\n  - æ•æ„Ÿç”¨æˆ·æ•°æ®æ³„éœ²ï¼ˆå¦‚å¯†ç ã€ä¸ªäººä¿¡æ¯ï¼‰\n  - å¯èƒ½è¢«ç”¨äºè¿›ä¸€æ­¥æ”»å‡»ç³»ç»Ÿ\n- **ä¿®å¤æ–¹æ¡ˆ**ï¼š\n```python\nfrom sqlalchemy import text\ndef safe_sql_query(user_id):\n    query = text(\"SELECT * FROM users WHERE id = :user_id\")\n    return query.bindparam(user_id=user_id)\n```\n\n---\n\n## ğŸš¨ æ¼æ´ #2ï¼šè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰\n- **OWASPåˆ†ç±»**ï¼šA07:2021 - èº«ä»½è®¤è¯å’Œä¼šè¯ç®¡ç†\n- **CWEç¼–å·**ï¼šCWE-79\n- **ä¸¥é‡ç¨‹åº¦**ï¼šé«˜å±\n- **ä½ç½®**ï¼šç¬¬11-12è¡Œï¼Œæ–‡ä»¶ test_complete_report.py\n- **ä»£ç ç‰‡æ®µ**ï¼š\n```python\ndef xss_vulnerability(user_input):\n    # XSSæ¼æ´ç¤ºä¾‹\n    return f\"<div>ç”¨æˆ·è¾“å…¥: {user_input}</div>\"\n```\n- **æ”»å‡»åœºæ™¯**ï¼š\n  1. æ”»å‡»è€…æäº¤å¦‚ä¸‹å†…å®¹ä½œä¸º `user_input`ï¼š\n     ```html\n     <script>alert('XSS')</script>\n     ```\n  2. é¡µé¢æ¸²æŸ“åä¼šæ‰§è¡Œè¯¥è„šæœ¬ï¼Œå¯èƒ½çªƒå–ç”¨æˆ·cookieæˆ–é‡å®šå‘åˆ°é’“é±¼ç½‘ç«™ã€‚\n- **ä¸šåŠ¡å½±å“**ï¼š\n  - ç”¨æˆ·æµè§ˆå™¨è¢«åŠ«æŒï¼Œå¯èƒ½å¯¼è‡´è´¦æˆ·è¢«ç›—\n  - å½±å“å“ç‰Œå½¢è±¡å’Œç”¨æˆ·ä¿¡ä»»\n- **ä¿®å¤æ–¹æ¡ˆ**ï¼š\n```python\nfrom markupsafe import escape\ndef safe_xss_output(user_input):\n    return f\"<div>ç”¨æˆ·è¾“å…¥: {escape(user_input)}</div>\"\n```\n\n---\n\n## ğŸš¨ æ¼æ´ #3ï¼šç¡¬ç¼–ç å¯†é’¥ï¼ˆHardcoded Secretsï¼‰\n- **OWASPåˆ†ç±»**ï¼šA07:2021 - èº«ä»½è®¤è¯å’Œä¼šè¯ç®¡ç†\n- **CWEç¼–å·**ï¼šCWE-259\n- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸¥é‡\n- **ä½ç½®**ï¼šç¬¬16-19è¡Œï¼Œæ–‡ä»¶ test_complete_report.py\n- **ä»£ç ç‰‡æ®µ**ï¼š\n```python\ndef hardcoded_secret():\n    # ç¡¬ç¼–ç å¯†é’¥æ¼æ´\n    api_key = \"sk-1234567890abcdef\"\n    database_password = \"admin123\"\n    return api_key, database_password\n```\n- **æ”»å‡»åœºæ™¯**ï¼š\n  1. æ”»å‡»è€…é€šè¿‡æºç åˆ†æè·å–APIå¯†é’¥å’Œæ•°æ®åº“å¯†ç ã€‚\n  2. åˆ©ç”¨è¿™äº›å‡­è¯è®¿é—®å¤–éƒ¨æœåŠ¡æˆ–æ•°æ®åº“ã€‚\n- **ä¸šåŠ¡å½±å“**ï¼š\n  - å¤–éƒ¨APIæ»¥ç”¨ï¼ˆå¦‚æ”¯ä»˜ã€é‚®ä»¶æœåŠ¡ï¼‰\n  - æ•°æ®åº“è¢«éæ³•è®¿é—®æˆ–ç¯¡æ”¹\n- **ä¿®å¤æ–¹æ¡ˆ**ï¼š\n```python\nimport os\ndef get_secrets():\n    api_key = os.getenv(\"API_KEY\")\n    db_password = os.getenv(\"DB_PASSWORD\")\n    return api_key, db_password\n```\n\n---\n\n## ğŸš¨ æ¼æ´ #4ï¼šå‘½ä»¤æ³¨å…¥ï¼ˆCommand Injectionï¼‰\n- **OWASPåˆ†ç±»**ï¼šA03:2021 - æ•°æ®æ³„éœ²\n- **CWEç¼–å·**ï¼šCWE-78\n- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸¥é‡\n- **ä½ç½®**ï¼šç¬¬24-25è¡Œï¼Œæ–‡ä»¶ test_complete_report.py\n- **ä»£ç ç‰‡æ®µ**ï¼š\n```python\ndef command_injection(filename):\n    # å‘½ä»¤æ³¨å…¥æ¼æ´\n    import os\n    os.system(f\"cat {filename}\")\n```\n- **æ”»å‡»åœºæ™¯**ï¼š\n  1. æ”»å‡»è€…ä¼ å…¥æ¶æ„å‚æ•°å¦‚ `\"; rm -rf /; echo \"`\n  2. æœ€ç»ˆæ‰§è¡Œå‘½ä»¤ä¸ºï¼š\n     ```bash\n     cat \"; rm -rf /; echo \"\n     ```\n  3. å¯èƒ½å¯¼è‡´æœåŠ¡å™¨è¢«å®Œå…¨åˆ é™¤æˆ–è¿œç¨‹ä»£ç æ‰§è¡Œã€‚\n- **ä¸šåŠ¡å½±å“**ï¼š\n  - æœåŠ¡å™¨è¢«ç ´åæˆ–è¢«ç”¨ä½œæ”»å‡»è·³æ¿\n  - ä¸šåŠ¡ä¸­æ–­ã€æ•°æ®ä¸¢å¤±\n- **ä¿®å¤æ–¹æ¡ˆ**ï¼š\n```python\nimport subprocess\ndef safe_command_execution(filename):\n    subprocess.run([\"cat\", filename], check=True)\n```\n\n---\n\n## ğŸš¨ æ¼æ´ #5ï¼šè·¯å¾„éå†ï¼ˆPath Traversalï¼‰\n- **OWASPåˆ†ç±»**ï¼šA05:2021 - å®‰å…¨é…ç½®é”™è¯¯\n- **CWEç¼–å·**ï¼šCWE-22\n- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸¥é‡\n- **ä½ç½®**ï¼šç¬¬29-31è¡Œï¼Œæ–‡ä»¶ test_complete_report.py\n- **ä»£ç ç‰‡æ®µ**ï¼š\n```python\ndef path_traversal(file_path):\n    # è·¯å¾„éå†æ¼æ´\n    with open(f\"uploads/{file_path}\", 'r') as f:\n        return f.read()\n```\n- **æ”»å‡»åœºæ™¯**ï¼š\n  1. æ”»å‡»è€…ä¼ å…¥ `../../../etc/passwd` ä½œä¸º `file_path`\n  2. å®é™…è¯»å–è·¯å¾„å˜ä¸ºï¼š\n     ```\n     uploads/../../../etc/passwd\n     ```\n  3. å¯è¯»å–ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼ˆå¦‚ `/etc/passwd`ï¼‰\n- **ä¸šåŠ¡å½±å“**ï¼š\n  - ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶æ³„éœ²\n  - å¯èƒ½å¯¼è‡´æƒé™æå‡æˆ–ä¿¡æ¯æ³„éœ²\n- **ä¿®å¤æ–¹æ¡ˆ**ï¼š\n```python\nimport os\ndef safe_path_traversal(file_path):\n    base_dir = \"uploads/\"\n    safe_path = os.path.abspath(os.path.join(base_dir, file_path))\n    if not safe_path.startswith(os.path.abspath(base_dir)):\n        raise ValueError(\"Invalid file path\")\n    with open(safe_path, 'r') as f:\n        return f.read()\n```\n\n---\n\n## ğŸš¨ æ¼æ´ #6ï¼šå¼±åŠ å¯†ç®—æ³•ï¼ˆMD5ï¼‰\n- **OWASPåˆ†ç±»**ï¼šA02:2021 - åçš„åŠ å¯†å®è·µ\n- **CWEç¼–å·**ï¼šCWE-327\n- **ä¸¥é‡ç¨‹åº¦**ï¼šé«˜å±\n- **ä½ç½®**ï¼šç¬¬35-37è¡Œï¼Œæ–‡ä»¶ test_complete_report.py\n- **ä»£ç ç‰‡æ®µ**ï¼š\n```python\ndef weak_crypto(password):\n    # å¼±åŠ å¯†ç®—æ³•\n    import hashlib\n    return hashlib.md5(password.encode()).hexdigest()\n```\n- **æ”»å‡»åœºæ™¯**ï¼š\n  1. æ”»å‡»è€…ä½¿ç”¨å½©è™¹è¡¨æˆ–æš´åŠ›ç ´è§£å·¥å…·å¿«é€Ÿç ´è§£MD5å“ˆå¸Œã€‚\n  2. è·å–åŸå§‹å¯†ç ï¼Œç”¨äºç™»å½•å…¶ä»–ç³»ç»Ÿã€‚\n- **ä¸šåŠ¡å½±å“**ï¼š\n  - ç”¨æˆ·å¯†ç æ³„éœ²ï¼Œå½±å“å¤šä¸ªè´¦æˆ·\n  - ç³»ç»Ÿå®‰å…¨æ€§ä¸¥é‡å—æŸ\n- **ä¿®å¤æ–¹æ¡ˆ**ï¼š\n```python\nimport hashlib\nimport secrets\n\ndef secure_hash(password):\n    salt = secrets.token_hex(16)\n    return hashlib.pbkdf2_hmac('sha256', password.encode(), salt.encode(), 100000).hex()\n```\n\n---\n\n## ğŸš¨ æ¼æ´ #7ï¼šæœªéªŒè¯è¾“å…¥ï¼ˆç¼ºä¹è¾“å…¥æ ¡éªŒï¼‰\n- **OWASPåˆ†ç±»**ï¼šA03:2021 - æ•°æ®æ³„éœ²\n- **CWEç¼–å·**ï¼šCWE-20\n- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­å±\n- **ä½ç½®**ï¼šæ‰€æœ‰å‡½æ•°ä¸­ï¼Œæ–‡ä»¶ test_complete_report.py\n- **ä»£ç ç‰‡æ®µ**ï¼š\n```python\ndef sql_injection_vuln(user_id):\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    return query\n```\n- **æ”»å‡»åœºæ™¯**ï¼š\n  - æœªå¯¹è¾“å…¥è¿›è¡Œä»»ä½•è¿‡æ»¤æˆ–éªŒè¯ï¼Œå®¹æ˜“è¢«æ³¨å…¥æ”»å‡»ã€‚\n- **ä¸šåŠ¡å½±å“**ï¼š\n  - å¯èƒ½å¼•å‘SQLæ³¨å…¥ã€XSSç­‰æ”»å‡»\n- **ä¿®å¤æ–¹æ¡ˆ**ï¼š\n```python\ndef validate_input(user_input):\n    if not isinstance(user_input, str) or len(user_input) > 100:\n        raise ValueError(\"Invalid input\")\n    return user_input\n```\n\n---\n\n## ğŸš¨ æ¼æ´ #8ï¼šé”™è¯¯ä¿¡æ¯æ³„éœ²ï¼ˆError Disclosureï¼‰\n- **OWASPåˆ†ç±»**ï¼šA03:2021 - æ•°æ®æ³„éœ²\n- **CWEç¼–å·**ï¼šCWE-209\n- **ä¸¥é‡ç¨‹åº¦**ï¼šä¸­å±\n- **ä½ç½®**ï¼šæ— æ˜ç¡®é”™è¯¯å¤„ç†ï¼Œæ–‡ä»¶ test_complete_report.py\n- **ä»£ç ç‰‡æ®µ**ï¼š\n```python\ndef path_traversal(file_path):\n    with open(f\"uploads/{file_path}\", 'r') as f:\n        return f.read()\n```\n- **æ”»å‡»åœºæ™¯**ï¼š\n  - è‹¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œç³»ç»Ÿè¿”å›è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼Œæš´éœ²æ–‡ä»¶ç»“æ„ã€‚\n- **ä¸šåŠ¡å½±å“**ï¼š\n  - æ”»å‡»è€…å¯åˆ©ç”¨é”™è¯¯ä¿¡æ¯è¿›è¡Œè¿›ä¸€æ­¥æ¸—é€\n- **ä¿®å¤æ–¹æ¡ˆ**ï¼š\n```python\ntry:\n    with open(safe_path, 'r') as f:\n        return f.read()\nexcept FileNotFoundError:\n    return \"æ–‡ä»¶æœªæ‰¾åˆ°\"\nexcept Exception as e:\n    return \"ç³»ç»Ÿé”™è¯¯\"\n```\n\n---\n\n## ğŸ” æ€»ç»“ä¸å»ºè®®\n\n| æ¼æ´ç¼–å· | æ¼æ´åç§°         | ä¸¥é‡ç¨‹åº¦ | OWASPåˆ†ç±» |\n|----------|------------------|----------|------------|\n| #1       | SQLæ³¨å…¥          | ä¸¥é‡     | A03        |\n| #2       | XSS              | é«˜å±     | A07        |\n| #3       | ç¡¬ç¼–ç å¯†é’¥       | ä¸¥é‡     | A07        |\n| #4       | å‘½ä»¤æ³¨å…¥         | ä¸¥é‡     | A03        |\n| #5       | è·¯å¾„éå†         | ä¸¥é‡     | A05        |\n| #6       | å¼±åŠ å¯†ç®—æ³•       | é«˜å±     | A02        |\n| #7       | è¾“å…¥éªŒè¯ç¼ºå¤±     | ä¸­å±     | A03        |\n| #8       | é”™è¯¯ä¿¡æ¯æ³„éœ²     | ä¸­å±     | A03        |\n\n---\n\n## ğŸ§  æ”»å‡»è€…è§†è§’æ€è€ƒ\n\nä½œä¸ºæ¸—é€æµ‹è¯•äººå‘˜ï¼Œæˆ‘ä¼šä¼˜å…ˆå°è¯•ä»¥ä¸‹æ”»å‡»è·¯å¾„ï¼š\n\n1. **SQLæ³¨å…¥**ï¼šå› ä¸ºå®ƒæ˜¯æœ€å¸¸è§ä¸”å½±å“æœ€å¤§çš„æ¼æ´ä¹‹ä¸€ï¼Œå¯ä»¥ç»•è¿‡è®¤è¯ã€è·å–æ•°æ®ã€‚\n2. **å‘½ä»¤æ³¨å…¥**ï¼šå¦‚æœè¯¥è„šæœ¬è¿è¡Œåœ¨æœåŠ¡å™¨ä¸Šï¼Œå‘½ä»¤æ³¨å…¥å¯ç›´æ¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚\n3. **è·¯å¾„éå†**ï¼šç”¨äºè¯»å–ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼Œå¦‚é…ç½®æ–‡ä»¶ã€æ—¥å¿—ç­‰ã€‚\n4. **ç¡¬ç¼–ç å¯†é’¥**ï¼šä¸€æ—¦è·å–ï¼Œå¯ç›´æ¥è®¿é—®å¤–éƒ¨APIæˆ–æ•°æ®åº“ã€‚\n5. **XSS**ï¼šç”¨äºçªƒå–ç”¨æˆ·ä¼šè¯æˆ–è¿›è¡Œé’“é±¼æ”»å‡»ã€‚\n\n---\n\n## âœ… å»ºè®®ä¿®å¤ä¼˜å…ˆçº§\n\n1. **ç«‹å³ä¿®å¤**ï¼šSQLæ³¨å…¥ã€å‘½ä»¤æ³¨å…¥ã€è·¯å¾„éå†ã€ç¡¬ç¼–ç å¯†é’¥\n2. **å°½å¿«ä¿®å¤**ï¼šXSSã€å¼±åŠ å¯†ç®—æ³•\n3. **åç»­ä¼˜åŒ–**ï¼šè¾“å…¥éªŒè¯ã€é”™è¯¯å¤„ç†\n\n--- \n\n> âš ï¸ **æ³¨æ„**ï¼šæ­¤ä»£ç ä»…ä¸ºæ¼”ç¤ºç”¨é€”ï¼Œå®é™…ç”Ÿäº§ç¯å¢ƒä¸­å¿…é¡»ä¸¥æ ¼éµå¾ªå®‰å…¨ç¼–ç è§„èŒƒï¼Œé¿å…ä»»ä½•å®‰å…¨é£é™©ã€‚",
    "model_used": "qwen",
    "tokens_used": 3789
  }
]