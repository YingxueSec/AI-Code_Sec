graph TB
    subgraph "用户层"
        U1["👤 用户A"]
        U2["👤 用户B"] 
        U3["👤 用户C"]
    end
    
    subgraph "审计引擎"
        AE["🚀 AuditEngine<br/>主引擎"]
        SM["📋 SessionManager<br/>会话管理器"]
        SI["🔒 SessionIsolationManager<br/>会话隔离管理器"]
    end
    
    subgraph "会话层"
        S1["🔄 Session-1<br/>项目A审计<br/>用户A发起"]
        S2["🔄 Session-2<br/>项目B审计<br/>用户B发起"]
        S3["🔄 Session-3<br/>项目A审计<br/>用户C发起"]
        S4["🔄 Session-4<br/>项目C审计<br/>用户A发起"]
    end
    
    subgraph "隔离上下文"
        subgraph "Session-1环境"
            SC1["📦 SessionContext-1"]
            MN1["🧠 内存命名空间<br/>session_1_memory"]
            CN1["💾 缓存命名空间<br/>session_1_cache"]
            TD1["📁 临时目录<br/>/tmp/session_1/"]
        end
        
        subgraph "Session-2环境"
            SC2["📦 SessionContext-2"]
            MN2["🧠 内存命名空间<br/>session_2_memory"]
            CN2["💾 缓存命名空间<br/>session_2_cache"]
            TD2["📁 临时目录<br/>/tmp/session_2/"]
        end
        
        subgraph "Session-3环境"
            SC3["📦 SessionContext-3"]
            MN3["🧠 内存命名空间<br/>session_3_memory"]
            CN3["💾 缓存命名空间<br/>session_3_cache"]
            TD3["📁 临时目录<br/>/tmp/session_3/"]
        end
    end
    
    subgraph "共享资源层"
        SR1["🗂️ 项目元数据缓存<br/>只读共享"]
        SR2["🤖 LLM模型缓存<br/>只读共享"]
        SR3["🛡️ 安全规则库<br/>只读共享"]
        SR4["🗄️ 分析结果数据库<br/>读写控制"]
    end
    
    subgraph "项目层"
        P1["📂 项目A<br/>代码仓库"]
        P2["📂 项目B<br/>代码仓库"]
        P3["📂 项目C<br/>代码仓库"]
    end
    
    %% 用户到会话的关系
    U1 --> S1
    U1 --> S4
    U2 --> S2
    U3 --> S3
    
    %% 引擎管理关系
    AE --> SM
    AE --> SI
    SM --> S1
    SM --> S2
    SM --> S3
    SM --> S4
    
    %% 会话隔离关系
    SI --> SC1
    SI --> SC2
    SI --> SC3
    S1 --> SC1
    S2 --> SC2
    S3 --> SC3
    
    %% 隔离上下文内部关系
    SC1 --> MN1
    SC1 --> CN1
    SC1 --> TD1
    SC2 --> MN2
    SC2 --> CN2
    SC2 --> TD2
    SC3 --> MN3
    SC3 --> CN3
    SC3 --> TD3
    
    %% 会话到项目的关系
    S1 --> P1
    S2 --> P2
    S3 --> P1
    S4 --> P3
    
    %% 共享资源访问
    S1 -.->|受控访问| SR1
    S1 -.->|受控访问| SR2
    S1 -.->|受控访问| SR3
    S1 -.->|受控访问| SR4
    S2 -.->|受控访问| SR1
    S2 -.->|受控访问| SR2
    S2 -.->|受控访问| SR3
    S2 -.->|受控访问| SR4
    S3 -.->|受控访问| SR1
    S3 -.->|受控访问| SR2
    S3 -.->|受控访问| SR3
    S3 -.->|受控访问| SR4
