{
  "project_path": "examples/test_oa-system",
  "template": "owasp_top_10_2021",
  "total_files": 10,
  "findings": [
    {
      "file": "src/main/resources/static/plugins/kindeditor/plugins/baidumap/index.html",
      "language": "javascript",
      "type": "XSS跨站脚本攻击",
      "severity": "medium",
      "line": 28,
      "description": "代码直接使用getParam函数获取的参数拼接到DOM中，未进行任何转义或过滤处理。如果用户传入的参数包含恶意脚本，可能导致XSS攻击。",
      "code_snippet": "dituContent.style.width = widthParam + 'px';\ndituContent.style.height = heightParam + 'px';",
      "impact": "攻击者可能注入恶意脚本，在用户浏览器中执行，窃取用户信息或进行钓鱼攻击。",
      "recommendation": "对所有来自URL参数的输入进行HTML转义处理，或使用安全的DOM操作方法，如使用textContent而非innerHTML。",
      "issues": [
        "代码直接使用getParam函数获取的参数拼接到DOM中，未进行任何转义或过滤处理。如果用户传入的参数包含恶意脚本，可能导致XSS攻击。"
      ],
      "confidence": 0.948,
      "confidence_factors": {
        "framework_protection": 1.0,
        "architecture_appropriateness": 1.0,
        "code_complexity": 0.7200000000000001,
        "pattern_reliability": 1.0,
        "context_completeness": 0.9,
        "historical_accuracy": 1.0
      },
      "confidence_reasoning": [
        "代码片段过短(2行)，可能缺乏足够上下文",
        "代码复杂度较低，可能是简单的框架调用",
        "缺少调用链信息，无法完整分析数据流"
      ],
      "risk_level": "high"
    },
    {
      "file": "src/main/resources/static/plugins/kindeditor/plugins/baidumap/index.html",
      "language": "javascript",
      "type": "XSS跨站脚本攻击",
      "severity": "medium",
      "line": 37,
      "description": "markersParam参数被直接用于split操作后拼接到BMap.Point构造函数中，若参数包含恶意内容，可能引发XSS或地图API滥用。",
      "code_snippet": "var markersArr = markersParam.split(',');\nvar point = new BMap.Point(markersArr[0], markersArr[1]);",
      "impact": "攻击者可能通过构造恶意参数，注入脚本或触发地图API的非预期行为。",
      "recommendation": "对markersParam参数进行严格的输入验证和清理，确保其符合预期格式，避免直接用于地图API构造。",
      "issues": [
        "markersParam参数被直接用于split操作后拼接到BMap.Point构造函数中，若参数包含恶意内容，可能引发XSS或地图API滥用。"
      ],
      "confidence": 0.948,
      "confidence_factors": {
        "framework_protection": 1.0,
        "architecture_appropriateness": 1.0,
        "code_complexity": 0.7200000000000001,
        "pattern_reliability": 1.0,
        "context_completeness": 0.9,
        "historical_accuracy": 1.0
      },
      "confidence_reasoning": [
        "代码片段过短(2行)，可能缺乏足够上下文",
        "代码复杂度较低，可能是简单的框架调用",
        "缺少调用链信息，无法完整分析数据流"
      ],
      "risk_level": "high"
    },
    {
      "file": "src/main/resources/static/plugins/kindeditor/plugins/baidumap/index.html",
      "language": "javascript",
      "type": "XSS跨站脚本攻击",
      "severity": "medium",
      "line": 42,
      "description": "centerParam参数被直接用于split操作后拼接到BMap.Point构造函数中，若参数包含恶意内容，可能引发XSS或地图API滥用。",
      "code_snippet": "var centerArr = centerParam.split(',');\nvar point = new BMap.Point(centerArr[0], centerArr[1]);",
      "impact": "攻击者可能通过构造恶意参数，注入脚本或触发地图API的非预期行为。",
      "recommendation": "对centerParam参数进行严格的输入验证和清理，确保其符合预期格式，避免直接用于地图API构造。",
      "issues": [
        "centerParam参数被直接用于split操作后拼接到BMap.Point构造函数中，若参数包含恶意内容，可能引发XSS或地图API滥用。"
      ],
      "confidence": 0.948,
      "confidence_factors": {
        "framework_protection": 1.0,
        "architecture_appropriateness": 1.0,
        "code_complexity": 0.7200000000000001,
        "pattern_reliability": 1.0,
        "context_completeness": 0.9,
        "historical_accuracy": 1.0
      },
      "confidence_reasoning": [
        "代码片段过短(2行)，可能缺乏足够上下文",
        "代码复杂度较低，可能是简单的框架调用",
        "缺少调用链信息，无法完整分析数据流"
      ],
      "risk_level": "high"
    },
    {
      "file": "src/main/resources/static/plugins/kindeditor/plugins/baidumap/index.html",
      "language": "javascript",
      "type": "代码注入",
      "severity": "low",
      "line": 12,
      "description": "代码使用了RegExp构造器动态生成正则表达式，虽然没有直接使用eval或Function构造器，但动态正则表达式可能引发ReDoS风险，尤其是在处理恶意输入时。",
      "code_snippet": "return location.href.match(new RegExp('[?&]' + name + '=([^?&]+)', 'i')) ? decodeURIComponent(RegExp.$1) : '';",
      "impact": "如果用户输入的参数名或值包含特殊正则表达式字符，可能导致正则表达式性能问题。",
      "recommendation": "考虑使用静态正则表达式或对输入参数进行严格验证，避免动态构造复杂正则表达式。",
      "issues": [
        "代码使用了RegExp构造器动态生成正则表达式，虽然没有直接使用eval或Function构造器，但动态正则表达式可能引发ReDoS风险，尤其是在处理恶意输入时。"
      ],
      "confidence": 0.948,
      "confidence_factors": {
        "framework_protection": 1.0,
        "architecture_appropriateness": 1.0,
        "code_complexity": 0.7200000000000001,
        "pattern_reliability": 1.0,
        "context_completeness": 0.9,
        "historical_accuracy": 1.0
      },
      "confidence_reasoning": [
        "代码片段过短(1行)，可能缺乏足够上下文",
        "代码复杂度较低，可能是简单的框架调用",
        "缺少调用链信息，无法完整分析数据流"
      ],
      "risk_level": "high"
    }
  ],
  "summary": {
    "total_findings": 4,
    "files_analyzed": 10,
    "completion_status": "success"
  },
  "timestamp": "2025-08-20 14:47:52.937283"
}